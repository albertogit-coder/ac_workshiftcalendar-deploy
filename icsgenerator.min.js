
function generate_ics(){var e=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n";var t=$("#sel-anno").text();console.log(t);var n=$("#sel-mese").val();console.log(n);let a="TURNI_"+t+n+"_CALENDAR";var o=new Date,r=("0000"+o.getFullYear().toString()).slice(-4),i=("00"+(o.getMonth()+1).toString()).slice(-2),s=("00"+o.getDate().toString()).slice(-2),l=("00"+o.getHours().toString()).slice(-2),c=("00"+o.getMinutes().toString()).slice(-2),g=("00"+o.getSeconds().toString()).slice(-2),d=r+i+s+("T"+l+c+g),S=[],u=["BEGIN:VCALENDAR","PRODID:ACSHIFT_1.0-Workshift-Calendar-Generator//ACarlesso//IT","VERSION:1.0","CALSCALE:GREGORIAN","X-WR-CALNAME;VALUE=TEXT:"+a].join(e),T=e+"END:VCALENDAR",D=["070000","140000"],A=["140000","220000"],E=["220000","070000"];$("input[type=radio]:checked","#formshift").each(function(a){console.log($(this).data());let o=$(this).data("day"),l="",c="",g="",u="",T="",N="",h="",f="";switch($(this).data("shift")){case"M":g=t,u=n,T=o,l=D[0],N=t,h=n,f=o,c=D[1];break;case"P":g=t,u=n,T=o,l=A[0],N=t,h=n,f=o,c=A[1];break;case"N":g=t,u=n,T=o,l=E[0];let e=new Date(g+"-"+u+"-"+T+"T00:00").addDays(1);N=e.getFullYear().toString(),h=("00"+(e.getMonth()+1).toString()).slice(-2),f=("00"+e.getDate().toString()).slice(-2),c=E[1];break;default:return console.log("Nessun Turno"),!1}let v=g+u+T+"T"+l,I=N+h+f+"T"+c;var R=["BEGIN:VEVENT","UID:"+S.length+"TURNIOSS@ACShiftGenerator"+r+i+s,"DESCRIPTION:Turno OSS","DTSTAMP:"+d,"DTSTART:"+v,"DTEND:"+I,"LOCATION:Ospedale","SUMMARY:Turno OSS","END:VEVENT"];R=R.join(e),S.push(R)}),function(t,n){if(S.length<1)return alert("Attenzione: Nessun Turno Impostato");n=void 0!==n?n:".ics",t=void 0!==t?t:"calendar";var a,o=u+e+S.join(e)+T;if(-1===navigator.userAgent.indexOf("MSIE 10"))a=new Blob([o]);else{var r=new BlobBuilder;r.append(o),a=r.getBlob("text/x-vCalendar;charset="+document.characterSet)}var i=document.createElement("a");i.download=t+n,i.href=window.URL.createObjectURL(a),i.click(),i.remove()}(a,".ics")}Date.prototype.addDays=function(e){const t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};